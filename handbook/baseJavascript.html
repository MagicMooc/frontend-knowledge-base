<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JSåŸºç¡€ | ğŸ˜å‰ç«¯çŸ¥è¯†åº“@MagicMooc</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/icon.png">
    <meta name="description" content="å¥½å¥½å­¦ä¹ ï¼Œå¤©å¤©å‘ä¸ŠğŸ¥³">
    
    <link rel="preload" href="/assets/css/0.styles.7b8b3c13.css" as="style"><link rel="preload" href="/assets/js/app.ec3c4e52.js" as="script"><link rel="preload" href="/assets/js/3.a4c2a10e.js" as="script"><link rel="preload" href="/assets/js/1.f00e5e10.js" as="script"><link rel="preload" href="/assets/js/24.f5876fa3.js" as="script"><link rel="prefetch" href="/assets/js/10.bb129b2a.js"><link rel="prefetch" href="/assets/js/11.1c4bf472.js"><link rel="prefetch" href="/assets/js/12.3c287ffb.js"><link rel="prefetch" href="/assets/js/13.bfcd80bb.js"><link rel="prefetch" href="/assets/js/14.720be740.js"><link rel="prefetch" href="/assets/js/15.5decac69.js"><link rel="prefetch" href="/assets/js/16.1f1e7299.js"><link rel="prefetch" href="/assets/js/17.d6cd6f0f.js"><link rel="prefetch" href="/assets/js/18.7e841435.js"><link rel="prefetch" href="/assets/js/19.b95bbb17.js"><link rel="prefetch" href="/assets/js/20.2072067c.js"><link rel="prefetch" href="/assets/js/21.358dfb7a.js"><link rel="prefetch" href="/assets/js/22.6310a9e3.js"><link rel="prefetch" href="/assets/js/23.c0e4fd1c.js"><link rel="prefetch" href="/assets/js/25.09fb8c44.js"><link rel="prefetch" href="/assets/js/26.e0f5d0ea.js"><link rel="prefetch" href="/assets/js/27.7719ab24.js"><link rel="prefetch" href="/assets/js/28.17497b4f.js"><link rel="prefetch" href="/assets/js/29.de5f18ab.js"><link rel="prefetch" href="/assets/js/30.b9f57264.js"><link rel="prefetch" href="/assets/js/31.6e88de0c.js"><link rel="prefetch" href="/assets/js/32.65039cba.js"><link rel="prefetch" href="/assets/js/33.1f8582e6.js"><link rel="prefetch" href="/assets/js/34.231dff0c.js"><link rel="prefetch" href="/assets/js/35.8cfa85d6.js"><link rel="prefetch" href="/assets/js/36.e27e4fd8.js"><link rel="prefetch" href="/assets/js/37.01e2f16c.js"><link rel="prefetch" href="/assets/js/4.6fb38d24.js"><link rel="prefetch" href="/assets/js/5.5db26bf5.js"><link rel="prefetch" href="/assets/js/6.2bd1e2c1.js"><link rel="prefetch" href="/assets/js/7.685fbbae.js"><link rel="prefetch" href="/assets/js/8.126b558b.js"><link rel="prefetch" href="/assets/js/9.5b8e69c4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7b8b3c13.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-130b300a><div data-v-130b300a><div class="password-shadow password-wrapper-out" style="display:none;" data-v-25ba6db2 data-v-130b300a data-v-130b300a><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>ğŸ˜å‰ç«¯çŸ¥è¯†åº“@MagicMooc</h3> <p class="description" data-v-25ba6db2 data-v-25ba6db2>å¥½å¥½å­¦ä¹ ï¼Œå¤©å¤©å‘ä¸ŠğŸ¥³</p> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><!---->
          Â Â 
          <!---->
          2022
        </a></span></div></div> <div class="hide" data-v-130b300a><header class="navbar" data-v-130b300a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">ğŸ˜å‰ç«¯çŸ¥è¯†åº“@MagicMooc</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  é¦–é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      more about me
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/MagicMooc" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://magicmooc.top/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  My blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-130b300a></div> <aside class="sidebar" data-v-130b300a><div class="personal-info-wrapper" data-v-39576ba9 data-v-130b300a><!----> <!----> <div class="num" data-v-39576ba9><div data-v-39576ba9><h3 data-v-39576ba9>19</h3> <h6 data-v-39576ba9>æ–‡ç« </h6></div> <div data-v-39576ba9><h3 data-v-39576ba9>0</h3> <h6 data-v-39576ba9>æ ‡ç­¾</h6></div></div> <ul class="social-links" data-v-39576ba9></ul> <hr data-v-39576ba9></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  é¦–é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      more about me
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/MagicMooc" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://magicmooc.top/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  My blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/about/welcome" class="sidebar-heading clickable"><span>Hey! This is MagicMooc</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/" aria-current="page" class="sidebar-link">æ¬¢è¿æ¥åˆ°æˆ‘çš„å‰ç«¯çŸ¥è¯†åº“â­ï¸</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/handbook/overview" class="sidebar-heading clickable open"><span>å‰ç«¯çŸ¥è¯†åº“ğŸ’»</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/handbook/baseLayout.html" class="sidebar-link">ğŸŒ´å‰ç«¯åŸºç¡€-layout</a></li><li><a href="/handbook/baseJavascript.html" aria-current="page" class="active sidebar-link">ğŸ€å‰ç«¯åŸºç¡€-javascript-åŸºç¡€</a></li><li><a href="/handbook/javascriptWeb.html" class="sidebar-link">ğŸŒµå‰ç«¯åŸºç¡€-javascript-web</a></li><li><a href="/handbook/network.html" class="sidebar-link">ğŸŒ²è®¡ç®—æœºç½‘ç»œ</a></li><li><a href="/handbook/browser.html" class="sidebar-link">ğŸª´æµè§ˆå™¨</a></li><li><a href="/handbook/engineering.html" class="sidebar-link">ğŸªµå‰ç«¯å·¥ç¨‹åŒ–</a></li><li><a href="/handbook/react.html" class="sidebar-link">ğŸŒ¿React</a></li><li><a href="/handbook/wheel.html" class="sidebar-link">ğŸƒæ‰‹å†™ä»£ç é—®é¢˜ï¼ˆé€ è½®å­ï¼‰</a></li><li><a href="/handbook/optimization.html" class="sidebar-link">ğŸŒ³æ€§èƒ½ä¼˜åŒ–é—®é¢˜</a></li><li><a href="/handbook/interviewExperience.html" class="sidebar-link">ğŸé¢è¯•ç»éªŒæ±‡æ€»</a></li><li><a href="/handbook/workExperience.html" class="sidebar-link">ğŸŒµå·¥ä½œç»éªŒæ±‡æ€»</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/algorithm/overview" class="sidebar-heading clickable"><span>å¿…ä¼šçš„ç®—æ³•é¢˜,å¹²!!!ğŸ”¥</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/algorithm/programmercarl/overview" class="sidebar-heading clickable open"><span>ğŸä»£ç éšæƒ³å½•</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/algorithm/programmercarl/Array.html" class="sidebar-link">ğŸ¦æ•°ç»„</a></li><li><a href="/algorithm/programmercarl/LinkedList.html" class="sidebar-link">ğŸ©é“¾è¡¨</a></li><li><a href="/algorithm/programmercarl/StackAndQueue.html" class="sidebar-link">ğŸ¥›æ ˆå’Œé˜Ÿåˆ—</a></li><li><a href="/algorithm/programmercarl/Tree.html" class="sidebar-link">ğŸ°äºŒå‰æ ‘</a></li><li><a href="/algorithm/programmercarl/Backtracking.html" class="sidebar-link">ğŸ¥å›æº¯ç®—æ³•</a></li><li><a href="/algorithm/programmercarl/Greedy.html" class="sidebar-link">ğŸªè´ªå¿ƒç®—æ³•</a></li><li><a href="/algorithm/programmercarl/DP.html" class="sidebar-link">ğŸ£åŠ¨æ€è§„åˆ’</a></li><li><a href="/algorithm/programmercarl/mStack.html" class="sidebar-link">ğŸ«•å•è°ƒæ ˆ</a></li></ul></section></li><li><a href="/algorithm/LeetcodeHot100.html" class="sidebar-link">ğŸŠLeetcodeçƒ­é¢˜100</a></li><li><a href="/algorithm/SwordToOffer.html" class="sidebar-link">ğŸ‹å‰‘æŒ‡Offer</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/interview/overview" class="sidebar-heading clickable"><span>å…«è‚¡æ–‡,çˆ†!!!ğŸš€</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/interview/everyday.html" class="sidebar-link">ğŸæ¯æ—¥ä¸€é¢˜</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-25ba6db2 data-v-130b300a><h3 class="title" data-v-25ba6db2 data-v-25ba6db2></h3> <!----> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><!---->
          Â Â 
          <!---->
          2022
        </a></span></div></div> <div data-v-130b300a><main class="page"><section><div class="page-title"><h1 class="title">JSåŸºç¡€</h1> <div data-v-f875f3fc><!----> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h1 id="jsåŸºç¡€"><a href="#jsåŸºç¡€" class="header-anchor">#</a> JSåŸºç¡€</h1> <h2 id="å˜é‡ç±»å‹ä¸è®¡ç®—"><a href="#å˜é‡ç±»å‹ä¸è®¡ç®—" class="header-anchor">#</a> å˜é‡ç±»å‹ä¸è®¡ç®—</h2> <h3 id="ç±»å‹è½¬æ¢"><a href="#ç±»å‹è½¬æ¢" class="header-anchor">#</a> ç±»å‹è½¬æ¢</h3> <h4 id="å­—ç¬¦ä¸²æ‹¼æ¥"><a href="#å­—ç¬¦ä¸²æ‹¼æ¥" class="header-anchor">#</a> å­—ç¬¦ä¸²æ‹¼æ¥</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">+</span> <span class="token string">'10'</span><span class="token punctuation">;</span> <span class="token comment">// '10010'</span>
<span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token operator">+</span> <span class="token string">'10'</span><span class="token punctuation">;</span> <span class="token comment">// 'true10'</span>
</code></pre></div><h4 id=""><a href="#" class="header-anchor">#</a> ==</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">100</span> <span class="token operator">==</span> <span class="token string">'100'</span> <span class="token comment">// true</span>
<span class="token number">0</span> <span class="token operator">==</span> <span class="token string">''</span> <span class="token comment">// true</span>
<span class="token number">0</span> <span class="token operator">==</span> <span class="token boolean">false</span> <span class="token comment">// true</span>
<span class="token boolean">false</span> <span class="token operator">==</span> <span class="token string">''</span> <span class="token comment">// true</span>
<span class="token keyword">null</span> <span class="token operator">==</span> <span class="token keyword">undefined</span> <span class="token comment">// true</span>
</code></pre></div><h4 id="ifè¯­å¥å’Œé€»è¾‘åˆ¤æ–­"><a href="#ifè¯­å¥å’Œé€»è¾‘åˆ¤æ–­" class="header-anchor">#</a> ifè¯­å¥å’Œé€»è¾‘åˆ¤æ–­</h4> <ul><li>trulyå˜é‡: <code>!!a === true</code> çš„å˜é‡</li> <li>falselyå˜é‡: <code>!!a === false</code>çš„å˜é‡</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ä»¥ä¸‹æ˜¯ falsely å˜é‡ï¼Œ é™¤æ­¤ä»¥å¤–éƒ½æ˜¯ truly å˜é‡</span>
<span class="token operator">!</span><span class="token operator">!</span><span class="token number">0</span> <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token operator">!</span><span class="token operator">!</span><span class="token constant">NAN</span> <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token operator">!</span><span class="token operator">!</span><span class="token string">&quot;&quot;</span> <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token operator">!</span><span class="token operator">!</span><span class="token keyword">null</span> <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token operator">!</span><span class="token operator">!</span><span class="token keyword">undefined</span> <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token operator">!</span><span class="token operator">!</span><span class="token boolean">false</span> <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="typeofèƒ½åˆ¤æ–­å“ªäº›ç±»å‹"><a href="#typeofèƒ½åˆ¤æ–­å“ªäº›ç±»å‹" class="header-anchor">#</a> typeofèƒ½åˆ¤æ–­å“ªäº›ç±»å‹ï¼Ÿ</h3> <ul><li>è¯†åˆ«æ‰€æœ‰å€¼ç±»å‹</li> <li>è¯†åˆ«å‡½æ•°</li> <li>åˆ¤æ–­æ˜¯å¦æ˜¯å¼•ç”¨ç±»å‹ï¼ˆä¸å¯å†ç»†èŠ‚ï¼‰</li></ul> <h3 id="ä½•æ—¶ä½¿ç”¨-ä½•æ—¶ä½¿ç”¨"><a href="#ä½•æ—¶ä½¿ç”¨-ä½•æ—¶ä½¿ç”¨" class="header-anchor">#</a> ä½•æ—¶ä½¿ç”¨<code>===</code>ï¼Œä½•æ—¶ä½¿ç”¨<code>==</code></h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// é™¤äº† == null ä¹‹å¤–ï¼Œå…¶ä»–ä¸€å¾‹éƒ½ç”¨===ï¼Œä¾‹å¦‚ï¼š</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span>a <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token comment">// ç›¸å½“äºï¼š</span>
<span class="token comment">// if (obj.a === null || obj.a === undefined) {}</span>

</code></pre></div><h3 id="å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹çš„åŒºåˆ«"><a href="#å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹çš„åŒºåˆ«" class="header-anchor">#</a> å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹çš„åŒºåˆ«</h3> <h3 id="æ‰‹å†™æ·±æ‹·è´"><a href="#æ‰‹å†™æ·±æ‹·è´" class="header-anchor">#</a> æ‰‹å†™æ·±æ‹·è´</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * æ·±æ‹·è´
 */</span>

<span class="token keyword">const</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">city</span><span class="token operator">:</span> <span class="token string">&quot;beijing&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">arr</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;c&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> obj2 <span class="token operator">=</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
obj2<span class="token punctuation">.</span>address<span class="token punctuation">.</span>city <span class="token operator">=</span> <span class="token string">&quot;shanghai&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">.</span>address<span class="token punctuation">.</span>city<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**
 *
 * @param {*} obj
 */</span>
<span class="token keyword">function</span> <span class="token function">deepClone</span><span class="token punctuation">(</span><span class="token parameter">obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> obj <span class="token operator">!==</span> <span class="token string">&quot;object&quot;</span> <span class="token operator">||</span> obj <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// obj æ˜¯ nullï¼Œæˆ–è€…ä¸æ˜¯å¯¹è±¡å’Œæ•°ç»„ï¼Œç›´æ¥è¿”å›</span>
    <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">//åˆå§‹åŒ–è¿”å›ç»“æœ</span>
  <span class="token keyword">let</span> result<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    result <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä¿è¯ key ä¸æ˜¯åŸå‹çš„å±æ€§</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// é€’å½’è°ƒç”¨!!!</span>
      result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// è¿”å›ç»“æœ</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="åŸå‹å’ŒåŸå‹é“¾"><a href="#åŸå‹å’ŒåŸå‹é“¾" class="header-anchor">#</a> åŸå‹å’ŒåŸå‹é“¾</h2> <h3 id="classå’Œç»§æ‰¿"><a href="#classå’Œç»§æ‰¿" class="header-anchor">#</a> classå’Œç»§æ‰¿</h3> <h4 id="class"><a href="#class" class="header-anchor">#</a> class</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>number <span class="token operator">=</span> number<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">å§“å </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ï¼Œå­¦å· </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>number<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">&quot;JOJO&quot;</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
x<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> y <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">&quot;YOYO&quot;</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>y<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>y<span class="token punctuation">.</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
y<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h4 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="header-anchor">#</a> ç»§æ‰¿</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">People</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> eat something</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token keyword">extends</span> <span class="token class-name">People</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>number <span class="token operator">=</span> number<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">å§“å </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ï¼Œå­¦å· </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>number<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Teacher</span> <span class="token keyword">extends</span> <span class="token class-name">People</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> major</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>major <span class="token operator">=</span> major<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">teach</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> æ•™æˆ </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>major<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">&quot;JOJO&quot;</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
x<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

x<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// å§“å undefined ï¼Œå­¦å· undefined</span>

<span class="token keyword">const</span> z <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Teacher</span><span class="token punctuation">(</span><span class="token string">&quot;ZOZO&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;math&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span>major<span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">teach</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="ç±»å‹åˆ¤æ–­instanceof"><a href="#ç±»å‹åˆ¤æ–­instanceof" class="header-anchor">#</a> ç±»å‹åˆ¤æ–­instanceof</h3> <div class="language-js extra-class"><pre class="language-js"><code>x <span class="token keyword">instanceof</span> <span class="token class-name">Student</span><span class="token punctuation">;</span>   <span class="token comment">// true</span>
x <span class="token keyword">instanceof</span> <span class="token class-name">People</span><span class="token punctuation">;</span>    <span class="token comment">// true</span>
x <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">;</span>    <span class="token comment">// true</span>

<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">;</span>  <span class="token comment">// true</span>
<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

</code></pre></div><p>é¡ºç€åŸå‹é“¾ç½‘ä¸Šæ‰¾</p> <h3 id="åŸå‹å’ŒåŸå‹é“¾-2"><a href="#åŸå‹å’ŒåŸå‹é“¾-2" class="header-anchor">#</a> åŸå‹å’ŒåŸå‹é“¾</h3> <h4 id="åŸå‹"><a href="#åŸå‹" class="header-anchor">#</a> åŸå‹</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// classå®é™…ä¸Šæ˜¯å‡½æ•°ï¼Œå¯è§æ˜¯è¯­æ³•ç³–</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> People<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// function</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> Student<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// function</span>

<span class="token comment">// éšå¼åŸå‹å’Œæ˜¾å¼åŸå‹</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// People {}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Student</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// People {}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Student</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p><img src="https://picmagic.oss-cn-beijing.aliyuncs.com/img/image-20220615091400544.png" alt="image-20220615091400544"></p> <ul><li>æ¯ä¸ªclasséƒ½æœ‰æ˜¾å¼åŸå‹prototype</li> <li>æ¯ä¸ªå®ä¾‹éƒ½æœ‰éšå¼åŸå‹<code>__proto__</code></li> <li>å®ä¾‹çš„<code>__proto__</code>æŒ‡å‘å¯¹åº”classçš„<code>prototype</code></li></ul> <h4 id="åŸºäºåŸå‹çš„æ‰§è¡Œè§„åˆ™"><a href="#åŸºäºåŸå‹çš„æ‰§è¡Œè§„åˆ™" class="header-anchor">#</a> åŸºäºåŸå‹çš„æ‰§è¡Œè§„åˆ™</h4> <ul><li>è·å–å±æ€§<code>x.name</code>æˆ–æ‰§è¡Œæ–¹æ³•<code>x.sayhi()</code>æ—¶</li> <li>å…ˆåœ¨è‡ªèº«å±æ€§å’Œæ–¹æ³•å¯»æ‰¾</li> <li>å¦‚æœæ‰¾ä¸åˆ°åˆ™è‡ªåŠ¨å»<code>__proto__</code>ä¸­æŸ¥æ‰¾</li></ul> <h4 id="åŸå‹é“¾"><a href="#åŸå‹é“¾" class="header-anchor">#</a> åŸå‹é“¾</h4> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Student</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">People</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">People</span><span class="token punctuation">.</span>prototype <span class="token operator">===</span> <span class="token class-name">Student</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

x<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
x<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">'sayHi'</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
</code></pre></div><p><img src="https://picmagic.oss-cn-beijing.aliyuncs.com/img/image-20220615092449721.png" alt="image-20220615092449721"></p> <p><img src="https://picmagic.oss-cn-beijing.aliyuncs.com/img/image-20220615093037962.png" alt="image-20220615093037962"></p> <h4 id="é‡è¦æç¤º-ï¸"><a href="#é‡è¦æç¤º-ï¸" class="header-anchor">#</a> é‡è¦æç¤ºâ€¼ï¸</h4> <ul><li>classæ˜¯ES6è¯­æ³•è§„èŒƒï¼Œç”±ECMAå§”å‘˜ä¼šå‘å¸ƒ</li> <li>ECMAåªè§„å®šè¯­æ³•è§„åˆ™ï¼Œå³æˆ‘ä»¬ä»£ç çš„ä¹¦å†™è§„èŒƒï¼Œä¸è§„å®šå¦‚ä½•å®ç°</li> <li>ä»¥ä¸Šå®ç°æ–¹å¼éƒ½æ˜¯V8å¼•æ“çš„å®ç°æ–¹å¼ï¼Œä¹Ÿæ˜¯ä¸»æµçš„</li></ul> <h3 id="å¦‚ä½•å‡†ç¡®åˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯ä¸æ˜¯æ•°ç»„"><a href="#å¦‚ä½•å‡†ç¡®åˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯ä¸æ˜¯æ•°ç»„" class="header-anchor">#</a> å¦‚ä½•å‡†ç¡®åˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯ä¸æ˜¯æ•°ç»„ï¼Ÿ</h3> <ul><li>a instanceof Array</li></ul> <h3 id="æ‰‹å†™ä¸€ä¸ªç®€æ˜“çš„jquery-è€ƒè™‘æ’ä»¶å’Œæ‰©å±•æ€§"><a href="#æ‰‹å†™ä¸€ä¸ªç®€æ˜“çš„jquery-è€ƒè™‘æ’ä»¶å’Œæ‰©å±•æ€§" class="header-anchor">#</a> æ‰‹å†™ä¸€ä¸ªç®€æ˜“çš„jQueryï¼Œè€ƒè™‘æ’ä»¶å’Œæ‰©å±•æ€§</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">jQuery</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">selector</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> result <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> length <span class="token operator">=</span> result<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">=</span> length<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>selector <span class="token operator">=</span> selector<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">get</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">each</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> elem <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">fn</span><span class="token punctuation">(</span>elem<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">on</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token parameter">elem</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            elem<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> fn<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// æ‰©å±•æ›´å¤šDOM API</span>


<span class="token punctuation">}</span>
<span class="token comment">// æ’ä»¶</span>
jQuery<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">dialog</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// é€ è½®å­</span>
<span class="token keyword">class</span> <span class="token class-name">myJQuery</span> <span class="token keyword">extends</span> <span class="token class-name">jQuery</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">selector</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// æ‰©å±•è‡ªå·±çš„æ–¹æ³•</span>
    <span class="token function">addClass</span><span class="token punctuation">(</span><span class="token parameter">className</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
    <span class="token function">style</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">const</span> $p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">jQuery</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
$p<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
$p<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">elem</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>elem<span class="token punctuation">.</span>nodeName<span class="token punctuation">)</span><span class="token punctuation">)</span>
$p<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'clicked'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
$p<span class="token punctuation">.</span><span class="token function">dialog</span><span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="classçš„åŸå‹æœ¬è´¨-æ€ä¹ˆç†è§£"><a href="#classçš„åŸå‹æœ¬è´¨-æ€ä¹ˆç†è§£" class="header-anchor">#</a> classçš„åŸå‹æœ¬è´¨ï¼Œæ€ä¹ˆç†è§£ï¼Ÿ</h3> <ul><li>åŸå‹å’ŒåŸå‹é“¾çš„å›¾ç¤º</li> <li>å±æ€§å’Œæ–¹æ³•çš„æ‰§è¡Œè§„åˆ™</li></ul> <h2 id="ä½œç”¨åŸŸä¸é—­åŒ…"><a href="#ä½œç”¨åŸŸä¸é—­åŒ…" class="header-anchor">#</a> ä½œç”¨åŸŸä¸é—­åŒ…</h2> <h3 id="ä½œç”¨åŸŸå’Œè‡ªç”±å˜é‡"><a href="#ä½œç”¨åŸŸå’Œè‡ªç”±å˜é‡" class="header-anchor">#</a> ä½œç”¨åŸŸå’Œè‡ªç”±å˜é‡</h3> <h4 id="ä½œç”¨åŸŸ"><a href="#ä½œç”¨åŸŸ" class="header-anchor">#</a> ä½œç”¨åŸŸ</h4> <img src="https://picmagic.oss-cn-beijing.aliyuncs.com/img/image-20220615104043408.png" alt="image-20220615104043408" style="zoom:50%;"> <h5 id="å…¨å±€ä½œç”¨åŸŸ"><a href="#å…¨å±€ä½œç”¨åŸŸ" class="header-anchor">#</a> å…¨å±€ä½œç”¨åŸŸ</h5> <h5 id="å‡½æ•°ä½œç”¨åŸŸ"><a href="#å‡½æ•°ä½œç”¨åŸŸ" class="header-anchor">#</a> å‡½æ•°ä½œç”¨åŸŸ</h5> <h5 id="å—çº§ä½œç”¨åŸŸ-es6æ–°å¢"><a href="#å—çº§ä½œç”¨åŸŸ-es6æ–°å¢" class="header-anchor">#</a> å—çº§ä½œç”¨åŸŸï¼ˆES6æ–°å¢ï¼‰</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ES6 å—çº§ä½œç”¨åŸŸ</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">100</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token comment">//ä¼šæŠ¥é”™</span>
</code></pre></div><h4 id="è‡ªç”±å˜é‡"><a href="#è‡ªç”±å˜é‡" class="header-anchor">#</a> è‡ªç”±å˜é‡</h4> <ul><li>ä¸€ä¸ªå˜é‡åœ¨å½“å‰ä½œç”¨åŸŸæ²¡æœ‰å®šä¹‰ï¼Œä½†è¢«ä½¿ç”¨äº†</li> <li>å‘ä¸Šçº§ä½œç”¨åŸŸï¼Œä¸€å±‚ä¸€å±‚ä¸€æ¬¡å¯»æ‰¾ï¼Œç›´è‡³æ‰¾åˆ°ä¸ºæ­¢</li> <li>å¦‚æœåˆ°å…¨å±€ä½œç”¨åŸŸéƒ½æ²¡æ‰¾åˆ°ï¼Œåˆ™æŠ¥é”™<code>xx is not defined</code></li></ul> <h3 id="é—­åŒ…"><a href="#é—­åŒ…" class="header-anchor">#</a> é—­åŒ…</h3> <p>ä½œç”¨åŸŸåº”ç”¨çš„ç‰¹æ®Šæƒ…å†µï¼Œæœ‰ä¸¤ç§è¡¨ç°:</p> <ul><li>å‡½æ•°ä½œä¸ºå‚æ•°è¢«ä¼ é€’</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å‡½æ•°ä½œä¸ºå‚æ•°</span>
<span class="token keyword">function</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
  <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">print</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 100</span>
</code></pre></div><ul><li>å‡½æ•°ä½œä¸ºè¿”å›å€¼è¢«è¿”å›</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å‡½æ•°ä½œä¸ºè¿”å›å€¼</span>
<span class="token keyword">function</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> fn <span class="token operator">=</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 100</span>
</code></pre></div><p>é—­åŒ…ï¼šæ‰€æœ‰è‡ªç”±å˜é‡çš„æŸ¥æ‰¾ï¼Œæ˜¯åœ¨å‡½æ•°å®šä¹‰çš„åœ°æ–¹ï¼Œå‘ä¸Šçº§ä½œç”¨åŸŸæŸ¥æ‰¾ï¼Œä¸æ˜¯åœ¨æ‰§è¡Œçš„åœ°æ–¹ï¼ï¼ï¼</p> <h3 id="this"><a href="#this" class="header-anchor">#</a> this</h3> <ul><li>ä½œä¸ºæ™®é€šå‡½æ•°</li> <li>ä½¿ç”¨call apply bind</li> <li>ä½œä¸ºå¯¹è±¡æ–¹æ³•è¢«è°ƒç”¨</li> <li>åœ¨classæ–¹æ³•ä¸­è°ƒç”¨</li> <li>ç®­å¤´å‡½æ•°</li></ul> <p>thiså–ä»€ä¹ˆå€¼æ˜¯å‡½æ•°åœ¨æ‰§è¡Œçš„æ—¶å€™å†³å®šçš„ï¼Œä¸æ˜¯åœ¨å®šä¹‰çš„æ—¶å€™å†³å®šçš„</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window</span>

<span class="token function">fn1</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { x: 100 }</span>

<span class="token comment">// bindä¼šè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°</span>
<span class="token keyword">const</span> fn2 <span class="token operator">=</span> <span class="token function">fn1</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">200</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { x: 200 }</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> zhangsan <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'å¼ ä¸‰'</span><span class="token punctuation">,</span>
  <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// this å³å½“å‰å¯¹è±¡</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// this === window</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> zhangsan <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'å¼ ä¸‰'</span><span class="token punctuation">,</span>
  <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// this å³å½“å‰å¯¹è±¡</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// this å³å½“å‰å¯¹è±¡</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="thisçš„ä¸åŒåº”ç”¨åœºæ™¯-å¦‚ä½•å–å€¼"><a href="#thisçš„ä¸åŒåº”ç”¨åœºæ™¯-å¦‚ä½•å–å€¼" class="header-anchor">#</a> thisçš„ä¸åŒåº”ç”¨åœºæ™¯ï¼Œå¦‚ä½•å–å€¼?</h3> <p>è§ä¸Š</p> <h3 id="æ‰‹å†™bindå‡½æ•°"><a href="#æ‰‹å†™bindå‡½æ•°" class="header-anchor">#</a> æ‰‹å†™bindå‡½æ•°</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">bind1</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å°†å‚æ•°è§£æä¸ºæ•°ç»„</span>
  <span class="token keyword">const</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// è·å– thisï¼ˆå–å‡ºæ•°ç»„ç¬¬ä¸€é¡¹ï¼Œæ•°ç»„å‰©ä½™çš„å°±æ˜¯ä¼ é€’çš„å‚æ•°ï¼‰</span>
  <span class="token keyword">const</span> t <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// fn1.bind(...)ä¸­çš„fn1</span>
  <span class="token keyword">const</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token comment">// å½“å‰å‡½æ•°</span>
  <span class="token comment">// è¿”å›ä¸€ä¸ªå‡½æ•°</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ‰§è¡ŒåŸå‡½æ•°ï¼Œå¹¶è¿”å›ç»“æœ</span>
    <span class="token keyword">return</span> <span class="token function">self</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span> 

<span class="token comment">//ä½¿ç”¨</span>
<span class="token keyword">function</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;this&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token string">'this is fn1'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> fn2 <span class="token operator">=</span> fn1<span class="token punctuation">.</span><span class="token function">bind1</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="å®é™…å¼€å‘ä¸­é—­åŒ…çš„åº”ç”¨åœºæ™¯-ä¸¾ä¾‹è¯´æ˜"><a href="#å®é™…å¼€å‘ä¸­é—­åŒ…çš„åº”ç”¨åœºæ™¯-ä¸¾ä¾‹è¯´æ˜" class="header-anchor">#</a> å®é™…å¼€å‘ä¸­é—­åŒ…çš„åº”ç”¨åœºæ™¯ï¼Œä¸¾ä¾‹è¯´æ˜</h3> <ul><li>éšè—æ•°æ®</li> <li>å¦‚åšä¸€ä¸ªç®€å•çš„cacheå·¥å…·</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// é—­åŒ…éšè—æ•°æ®ï¼Œåªæä¾›API</span>
<span class="token keyword">function</span> <span class="token function">createCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// é—­åŒ…ä¸­çš„æ•°æ®ï¼Œè¢«éšè—ï¼Œä¸è¢«å¤–ç•Œè®¿é—®</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      data<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> val<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token function">createCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="åˆ›å»º10ä¸ª-a-ç‚¹å‡»å¼¹å‡ºåºå·"><a href="#åˆ›å»º10ä¸ª-a-ç‚¹å‡»å¼¹å‡ºåºå·" class="header-anchor">#</a> åˆ›å»º10ä¸ª<code>&lt;a&gt;</code>,ç‚¹å‡»å¼¹å‡ºåºå·</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// åˆ›å»º10ä¸ª&lt;a&gt;æ ‡ç­¾ï¼Œç‚¹å‡»çš„æ—¶å€™å¼¹å‡ºæ¥å¯¹åº”çš„åºå·</span>
<span class="token keyword">let</span> i<span class="token punctuation">,</span> a<span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  a<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token string">'&lt;br&gt;'</span><span class="token punctuation">;</span>
  a<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// æ­¤æ—¶ä¸ç®¡ç‚¹å‡»é‚£ä¸ªéƒ½æ˜¯alert(10)</span>

<span class="token comment">// è§£å†³</span>
<span class="token keyword">let</span> a<span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  a<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token string">'&lt;br&gt;'</span><span class="token punctuation">;</span>
  a<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="å¼‚æ­¥"><a href="#å¼‚æ­¥" class="header-anchor">#</a> å¼‚æ­¥</h2> <h3 id="å•çº¿ç¨‹å’Œå¼‚æ­¥"><a href="#å•çº¿ç¨‹å’Œå¼‚æ­¥" class="header-anchor">#</a> å•çº¿ç¨‹å’Œå¼‚æ­¥</h3> <ul><li>JSæ˜¯å•çº¿ç¨‹è¯­è¨€ï¼Œåªèƒ½åŒæ—¶åšä¸€ä»¶äº‹å„¿</li> <li>æµè§ˆå™¨å’Œnodejså·²æ”¯æŒJSå¯åŠ¨è¿›ç¨‹ï¼Œå¦‚Web Worker</li> <li>JSå’ŒDOMæ¸²æŸ“å…±ç”¨åŒä¸€ä¸ªçº¿ç¨‹ï¼Œå› ä¸ºJSå¯ä¿®æ”¹DOMç»“æ„</li> <li>é‡åˆ°ç­‰å¾…ï¼ˆç½‘ç»œè¯·æ±‚ï¼Œå®šæ—¶ä»»åŠ¡ï¼‰ä¸èƒ½å¡ä½</li> <li>éœ€è¦å¼‚æ­¥</li> <li>å›è°ƒcallbackå‡½æ•°å½¢å¼</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å¼‚æ­¥ (callback å›è°ƒå‡½æ•°)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="header-anchor">#</a> åº”ç”¨åœºæ™¯</h3> <ul><li>ç½‘ç»œè¯·æ±‚ï¼Œå¦‚ajaxå›¾ç‰‡åŠ è½½</li> <li>å®šæ—¶ä»»åŠ¡ï¼Œå¦‚setTimeout</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ajax</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
$<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'./data1.json'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å›¾ç‰‡åŠ è½½</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'loaded'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'/xxx.png'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="callback-hell-å’Œ-promise"><a href="#callback-hell-å’Œ-promise" class="header-anchor">#</a> callback hell å’Œ Promise</h3> <h4 id="callback-hell"><a href="#callback-hell" class="header-anchor">#</a> callback hell</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// è·å–ç¬¬ä¸€ä»½æ•°æ®</span>
$<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url1<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">data1</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data1<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// è·å–ç¬¬äºŒä»½æ•°æ®</span>
  $<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url2<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">data2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// è·å–ç¬¬ä¸‰ä»½æ•°æ®</span>
    $<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url3<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">data3</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data3<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// è¿˜å¯èƒ½è·å–æ›´å¤šçš„æ•°æ®</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="promise"><a href="#promise" class="header-anchor">#</a> Promise</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      url<span class="token punctuation">,</span>
      <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">error</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">const</span> url1 <span class="token operator">=</span> <span class="token string">'/data1.json'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> url2 <span class="token operator">=</span> <span class="token string">'/data2.json'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> url3 <span class="token operator">=</span> <span class="token string">'/data3.json'</span><span class="token punctuation">;</span>
<span class="token function">getData</span><span class="token punctuation">(</span>url1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data1</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">getData</span><span class="token punctuation">(</span>url2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data2</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">getData</span><span class="token punctuation">(</span>url3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data3</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ"><a href="#åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ" class="header-anchor">#</a> åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ?</h3> <ul><li>åŸºäºJSæ˜¯å•çº¿ç¨‹è¯­è¨€</li> <li>å¼‚æ­¥ä¸ä¼šé˜»å¡ä»£ç æ‰§è¡Œ</li> <li>åŒæ­¥ä¼šé˜»å¡ä»£ç æ‰§è¡Œ</li></ul> <h3 id="æ‰‹å†™ç”¨promiseåŠ è½½ä¸€å¼ å›¾ç‰‡"><a href="#æ‰‹å†™ç”¨promiseåŠ è½½ä¸€å¼ å›¾ç‰‡" class="header-anchor">#</a> æ‰‹å†™ç”¨PromiseåŠ è½½ä¸€å¼ å›¾ç‰‡</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">loadImg</span><span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    img<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> err <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">å›¾ç‰‡åŠ è½½å¤±è´¥ </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>src<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    img<span class="token punctuation">.</span>src <span class="token operator">=</span> src<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> url1 <span class="token operator">=</span> <span class="token string">'https://t7.baidu.com/it/u=2961459243,2146986594&amp;fm=193&amp;f=GIF'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> url2 <span class="token operator">=</span> <span class="token string">'https://t7.baidu.com/it/u=4036010509,3445021118&amp;fm=193&amp;f=GIF'</span><span class="token punctuation">;</span>


<span class="token function">loadImg</span><span class="token punctuation">(</span>url1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">img1</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>img1<span class="token punctuation">.</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> img1<span class="token punctuation">;</span> <span class="token comment">// æ™®é€šå¯¹è±¡</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">img1</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>img1<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">loadImg</span><span class="token punctuation">(</span>url2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// promise å®ä¾‹</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">img2</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>img2<span class="token punctuation">.</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> img2<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">img2</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>img2<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span> <span class="token punctuation">(</span><span class="token parameter">ex</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="å‰ç«¯ä½¿ç”¨å¼‚æ­¥çš„åœºæ™¯æœ‰å“ªäº›"><a href="#å‰ç«¯ä½¿ç”¨å¼‚æ­¥çš„åœºæ™¯æœ‰å“ªäº›" class="header-anchor">#</a> å‰ç«¯ä½¿ç”¨å¼‚æ­¥çš„åœºæ™¯æœ‰å“ªäº›?</h3> <ul><li>ç½‘ç»œè¯·æ±‚ï¼Œå¦‚ajaxå›¾ç‰‡åŠ è½½</li> <li>å®šæ—¶ä»»åŠ¡ï¼Œå¦‚setTimeout</li></ul> <h3 id="ä»£ç é¢˜"><a href="#ä»£ç é¢˜" class="header-anchor">#</a> ä»£ç é¢˜</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// setTimeout ç¬”è¯•é¢˜</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="å¼‚æ­¥è¿›é˜¶"><a href="#å¼‚æ­¥è¿›é˜¶" class="header-anchor">#</a> å¼‚æ­¥è¿›é˜¶</h2> <h3 id="event-loop-äº‹ä»¶å¾ªç¯-äº‹ä»¶è½®è¯¢"><a href="#event-loop-äº‹ä»¶å¾ªç¯-äº‹ä»¶è½®è¯¢" class="header-anchor">#</a> event loop(äº‹ä»¶å¾ªç¯/äº‹ä»¶è½®è¯¢)</h3> <ul><li>JSæ˜¯å•çº¿ç¨‹è¿è¡Œçš„</li> <li>å¼‚æ­¥è¦åŸºäºå›è°ƒæ¥å®ç°</li> <li>event loopå°±æ˜¯å¼‚æ­¥å›è°ƒçš„å®ç°åŸç†</li></ul> <h4 id="jså¦‚ä½•æ‰§è¡Œ"><a href="#jså¦‚ä½•æ‰§è¡Œ" class="header-anchor">#</a> JSå¦‚ä½•æ‰§è¡Œï¼Ÿ</h4> <ul><li>ä»å‰åˆ°åï¼Œä¸€è¡Œä¸€è¡Œæ‰§è¡Œ</li> <li>å¦‚æœæŸä¸€è¡Œæ‰§è¡ŒæŠ¥é”™ï¼Œåˆ™åœæ­¢ä¸‹é¢ä»£ç çš„æ‰§è¡Œ</li> <li>å…ˆæŠŠåŒæ­¥ä»£ç æ‰§è¡Œå®Œï¼Œå†æ‰§è¡Œå¼‚æ­¥</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hi'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">cb1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'cb1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Bye'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://picmagic.oss-cn-beijing.aliyuncs.com/img/image-20220615202939662.png" alt="image-20220615202939662"></p> <h4 id="æ€»ç»“event-loopè¿‡ç¨‹"><a href="#æ€»ç»“event-loopè¿‡ç¨‹" class="header-anchor">#</a> æ€»ç»“event loopè¿‡ç¨‹</h4> <ul><li>åŒæ­¥ä»£ç ï¼Œä¸€è¡Œä¸€è¡Œæ”¾åœ¨Call Stackæ‰§è¡Œ</li> <li>é‡åˆ°å¼‚æ­¥ï¼Œä¼šå…ˆâ€œè®°å½•â€ä¸‹ï¼Œç­‰å¾…æ—¶æœºï¼ˆå®šæ—¶ï¼Œç½‘ç»œè¯·æ±‚ç­‰ï¼‰</li> <li>æ—¶æœºåˆ°äº†ï¼Œå°±ç§»åŠ¨åˆ°Callback Queue</li> <li>å¦‚Call Stackä¸ºç©ºï¼ˆå³åŒæ­¥ä»£ç æ‰§è¡Œå®Œï¼‰Event loopå¼€å§‹å·¥ä½œ</li> <li>è½®è¯¢æŸ¥æ‰¾Callback Queueï¼Œå¦‚æœ‰åˆ™ç§»åŠ¨åˆ°Call Stackæ‰§è¡Œ</li> <li>ç„¶åç»§ç»­è½®è¯¢æŸ¥æ‰¾ï¼ˆæ°¸åŠ¨æœºä¸€æ ·ï¼‰</li></ul> <h4 id="domäº‹ä»¶å’Œevent-loop"><a href="#domäº‹ä»¶å’Œevent-loop" class="header-anchor">#</a> DOMäº‹ä»¶å’Œevent loop</h4> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hi'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">cb1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'cb1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Bye'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>æäº¤<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hi'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#btn1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'button clicked'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Bye'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>DOMäº‹ä»¶ä¹Ÿä½¿ç”¨å›è°ƒï¼ŒåŸºäºevent loop</p> <h3 id="promise-2"><a href="#promise-2" class="header-anchor">#</a> Promise</h3> <h4 id="ä¸‰ç§çŠ¶æ€"><a href="#ä¸‰ç§çŠ¶æ€" class="header-anchor">#</a> ä¸‰ç§çŠ¶æ€</h4> <ul><li>pending resolved rejected</li> <li>pending-&gt;resolved æˆ– pending-&gt;rejected</li> <li>å˜åŒ–ä¸å¯é€†</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'p1'</span><span class="token punctuation">,</span> p1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// pending</span>

<span class="token keyword">const</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'p2'</span><span class="token punctuation">,</span> p2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// pending ä¸€å¼€å§‹æ‰“å°æ—¶</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'p2-setTimeout'</span><span class="token punctuation">,</span> p2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// fulfilled</span>

<span class="token keyword">const</span> p3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'p3'</span><span class="token punctuation">,</span> p3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// pending ä¸€å¼€å§‹æ‰“å°æ—¶</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'p3-setTimeout'</span><span class="token punctuation">,</span> p3<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// rejected</span>

</code></pre></div><h4 id="çŠ¶æ€çš„è¡¨ç°å’Œå˜åŒ–"><a href="#çŠ¶æ€çš„è¡¨ç°å’Œå˜åŒ–" class="header-anchor">#</a> çŠ¶æ€çš„è¡¨ç°å’Œå˜åŒ–</h4> <ul><li>pendingçŠ¶æ€ï¼Œä¸ä¼šè§¦å‘thenå’Œcatch</li> <li>resolvedçŠ¶æ€ï¼Œä¼šè§¦å‘åç»­çš„thenå›è°ƒå‡½æ•°</li> <li>rejectedçŠ¶æ€ï¼Œä¼šè§¦å‘åç»­çš„catchå›è°ƒå‡½æ•°</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> p1 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// console.log('p1', p1);</span>
p1<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data1'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'err1'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> p2 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'err'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// console.log('p2', p2);</span>
p2<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data2'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'err2'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="thenå’Œcatchå¯¹çŠ¶æ€çš„å½±å“"><a href="#thenå’Œcatchå¯¹çŠ¶æ€çš„å½±å“" class="header-anchor">#</a> thenå’Œcatchå¯¹çŠ¶æ€çš„å½±å“</h4> <ul><li>thenæ­£å¸¸è¿”å›resolvedï¼Œé‡Œé¢æœ‰æŠ¥é”™åˆ™è¿”å›rejected</li> <li>catchæ­£å¸¸è¿”å›resolvedï¼Œé‡Œé¢æœ‰æŠ¥é”™åˆ™è¿”å›rejected</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> p1 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">100</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// console.log('p1', p1); // fulfilled è§¦å‘åç»­ then å›è°ƒ</span>
p1<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'123'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'err'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token keyword">const</span> p2 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'then error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// console.log('p2', p2); // rejected è§¦å‘åç»­ catch å›è°ƒ</span>
p2<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'456'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'err'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token keyword">const</span> p3 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'my error'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'p3'</span><span class="token punctuation">,</span> p3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// fulfilled æ³¨æ„!!! è§¦å‘ then å›è°ƒ</span>
p3<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> p4 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'my error'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'catch err'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'p4'</span><span class="token punctuation">,</span> p4<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// rejected è§¦å‘ catch å›è°ƒ</span>
p4<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'some error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="ä»£ç é¢˜-2"><a href="#ä»£ç é¢˜-2" class="header-anchor">#</a> ä»£ç é¢˜</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ç¬¬ä¸€é¢˜</span>
Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 1 3</span>

<span class="token comment">// ç¬¬äºŒé¢˜</span>
Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'erro1'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 1 2 3</span>

<span class="token comment">// ç¬¬ä¸‰é¢˜</span>
Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  	<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'erro1'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 1 2 </span>
</code></pre></div><h3 id="async-await"><a href="#async-await" class="header-anchor">#</a> async/await</h3> <ul><li>å¼‚æ­¥å›è°ƒ callback hell</li> <li>Promise then catch é“¾å¼è°ƒç”¨ï¼Œä½†ä¹Ÿæ˜¯åŸºäºå›è°ƒå‡½æ•°</li> <li>async/awaitæ˜¯åŒæ­¥è¯­æ³•ï¼Œå½»åº•æ¶ˆç­å›è°ƒå‡½æ•°</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">loadImg</span><span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    img<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> err <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">å›¾ç‰‡åŠ è½½å¤±è´¥ </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>src<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    img<span class="token punctuation">.</span>src <span class="token operator">=</span> src<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> url1 <span class="token operator">=</span> <span class="token string">'https://t7.baidu.com/it/u=2961459243,2146986594&amp;fm=193&amp;f=GIF'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> url2 <span class="token operator">=</span> <span class="token string">'https://t7.baidu.com/it/u=4036010509,3445021118&amp;fm=193&amp;f=GIF'</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">loadImg1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> img1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">loadImg</span><span class="token punctuation">(</span>url1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> img1<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">loadImg2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> img2 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">loadImg</span><span class="token punctuation">(</span>url2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> img2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// img1</span>
  <span class="token keyword">const</span> img1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">loadImg1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>img1<span class="token punctuation">.</span>height<span class="token punctuation">,</span> img1<span class="token punctuation">.</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// img2</span>
  <span class="token keyword">const</span> img2 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">loadImg2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>img2<span class="token punctuation">.</span>height<span class="token punctuation">,</span> img2<span class="token punctuation">.</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><h4 id="async-await-å’Œ-promise-çš„å…³ç³»"><a href="#async-await-å’Œ-promise-çš„å…³ç³»" class="header-anchor">#</a> async/await å’Œ Promise çš„å…³ç³»</h4> <ul><li><p><code>async/await</code> æ˜¯æ¶ˆç­å¼‚æ­¥å›è°ƒçš„ç»ˆææ­¦å™¨</p></li> <li><p>ä½†å’Œ<code>Promise</code>å¹¶ä¸äº’æ–¥</p></li> <li><p>åè€Œï¼Œä¸¤è€…ç›¸è¾…ç›¸æˆ</p></li> <li><p>æ‰§è¡Œasyncå‡½æ•°ï¼Œè¿”å›çš„æ˜¯Promiseå¯¹è±¡</p></li> <li><p>awaitç›¸å½“äºPromiseçš„then</p></li> <li><p>try...catch å¯æ•è·å¼‚å¸¸ï¼Œä»£æ›¿äº†Promiseçš„catch</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// return 100;</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//  æ‰§è¡Œ async å‡½æ•°ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ª Promise å¯¹è±¡</span>
<span class="token keyword">const</span> res1 <span class="token operator">=</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'res1'</span><span class="token punctuation">,</span> res1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Promise å¯¹è±¡</span>
res1<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> p1 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> p1<span class="token punctuation">;</span> <span class="token comment">// await ç›¸å½“äº Promise then</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token number">400</span><span class="token punctuation">;</span> <span class="token comment">// await Promise.resolve(400)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data1'</span><span class="token punctuation">,</span> data1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data2 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data2'</span><span class="token punctuation">,</span> data2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> p4 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'err'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// rejected çŠ¶æ€</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> p4<span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span> <span class="token comment">// try...catch ç›¸å½“äº promise catch</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> p4 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'err1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// rejected çŠ¶æ€</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> p4<span class="token punctuation">;</span> <span class="token comment">//  await -&gt; then</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä¸æ‰“å°ï¼ŒUncaught (in promise) err1</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="å¼‚æ­¥çš„æœ¬è´¨"><a href="#å¼‚æ­¥çš„æœ¬è´¨" class="header-anchor">#</a> å¼‚æ­¥çš„æœ¬è´¨</h4> <ul><li>async/awaitæ˜¯æ¶ˆç­å¼‚æ­¥å›è°ƒ</li> <li>JSè¿˜æ˜¯å•çº¿ç¨‹ï¼Œè¿˜æ˜¯å¾—æœ‰å¼‚æ­¥ï¼Œè¿˜æ˜¯å¾—åŸºäºevent loop</li> <li>async/awaitåªæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œä½†è¿™é¢—ç³–çœŸé¦™ï¼</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2 é‡è¦</span>
    <span class="token keyword">await</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// awaitçš„åé¢ï¼Œéƒ½å¯ä»¥çœ‹åšæ˜¯ callback é‡Œçš„å†…å®¹ï¼Œå³å¼‚æ­¥</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 5</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3 é‡è¦</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
<span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 4</span>
<span class="token comment">// åŒæ­¥ä»£ç å·²ç»æ‰§è¡Œå®Œï¼ˆevent loopï¼‰</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
    <span class="token keyword">await</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// ä¸‹é¢ä¸‰è¡Œéƒ½æ˜¯å¼‚æ­¥å›è°ƒ callback çš„å†…å®¹</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 5</span>
    <span class="token keyword">await</span> <span class="token function">async3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// ä¸‹é¢ä¸€è¡Œæ˜¯å¼‚æ­¥å›è°ƒçš„å†…å®¹</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 end 2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 7</span>
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 6</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
<span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 4</span>
<span class="token comment">// åŒæ­¥ä»£ç æ‰§è¡Œå®Œ event loop</span>
</code></pre></div><h4 id="for-of"><a href="#for-of" class="header-anchor">#</a> for ... of</h4> <ul><li><code>for...in</code>(ä»¥åŠforEach for)æ˜¯å¸¸è§„çš„åŒæ­¥éå†</li> <li><code>for...of</code>å¸¸ç”¨äºå¼‚æ­¥çš„éå†</li></ul> <h3 id="å®ä»»åŠ¡macrotaskå’Œå¾®ä»»åŠ¡microtask"><a href="#å®ä»»åŠ¡macrotaskå’Œå¾®ä»»åŠ¡microtask" class="header-anchor">#</a> å®ä»»åŠ¡macroTaskå’Œå¾®ä»»åŠ¡microTask</h3> <ul><li>ä»€ä¹ˆæ˜¯å®ä»»åŠ¡ï¼Œä»€ä¹ˆæ˜¯å¾®ä»»åŠ¡ï¼Ÿ</li> <li>event loopå’ŒDOMæ¸²æŸ“</li> <li>å¾®ä»»åŠ¡å’Œå®ä»»åŠ¡çš„åŒºåˆ«</li></ul> <h4 id="å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡"><a href="#å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡" class="header-anchor">#</a> å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡</h4> <ul><li>å®ä»»åŠ¡ï¼š<code>setTimeout</code>,<code>setInterval</code>,<code>Ajax</code>,<code>DOM</code>äº‹ä»¶</li> <li>å¾®ä»»åŠ¡ï¼š<code>Promise</code>,<code>async/await</code></li> <li>å¾®ä»»åŠ¡æ‰§è¡Œæ—¶æœºæ¯”å®ä»»åŠ¡è¦æ—©</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 100 400 300 200 201</span>
</code></pre></div><h4 id="event-loop-å’Œ-domæ¸²æŸ“"><a href="#event-loop-å’Œ-domæ¸²æŸ“" class="header-anchor">#</a> event loop å’Œ DOMæ¸²æŸ“</h4> <ul><li><p>JSæ˜¯å•çº¿ç¨‹çš„ï¼Œè€Œä¸”å’ŒDOMæ¸²æŸ“å…±ç”¨ä¸€ä¸ªçº¿ç¨‹</p></li> <li><p>JSæ‰§è¡Œçš„æ—¶å€™ï¼Œå¾—ç•™ä¸€äº›æ—¶æœºä¾›DOMæ¸²æŸ“</p></li> <li><p>æ¯æ¬¡Call Stackæ¸…ç©ºï¼ˆå³æ¯æ¬¡è½®è¯¢ç»“æŸï¼‰ï¼Œå³åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œ</p></li> <li><p>éƒ½æ˜¯DOMé‡æ–°æ¸²æŸ“çš„æœºä¼šï¼ŒDOMç»“æ„å¦‚æœ‰æ”¹å˜åˆ™é‡æ–°æ¸²æŸ“</p></li> <li><p>ç„¶åå†å»è§¦å‘ä¸‹ä¸€æ¬¡Event Loop</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> $p1 <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'&lt;p&gt;ä¸€æ®µæ–‡å­—&lt;/p&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> $p2 <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'&lt;p&gt;ä¸€æ®µæ–‡å­—&lt;/p&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> $p3 <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'&lt;p&gt;ä¸€æ®µæ–‡å­—&lt;/p&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#container'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>$p1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>$p2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>$p3<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'length'</span><span class="token punctuation">,</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#container'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">children</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'æœ¬æ¬¡ call stack ç»“æŸï¼ŒDOMç»“æ„å·²æ›´æ–°ï¼Œä½†å°šæœªè§¦å‘æ¸²æŸ“'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ï¼ˆalert ä¼šé˜»æ–­ js æ‰§è¡Œï¼Œ ä¹Ÿä¼šé˜»æ–­ DOM æ¸²æŸ“ï¼Œ ä¾¿äºæŸ¥çœ‹æ•ˆæœï¼‰</span>
</code></pre></div><h4 id="å¾®ä»»åŠ¡å’Œå®ä»»åŠ¡çš„åŒºåˆ«"><a href="#å¾®ä»»åŠ¡å’Œå®ä»»åŠ¡çš„åŒºåˆ«" class="header-anchor">#</a> å¾®ä»»åŠ¡å’Œå®ä»»åŠ¡çš„åŒºåˆ«</h4> <ul><li>å®ä»»åŠ¡ï¼šDOMæ¸²æŸ“åè§¦å‘ï¼Œå¦‚<code>setTimeout</code></li> <li>å¾®ä»»åŠ¡ï¼šDOMæ¸²æŸ“å‰è§¦å‘ï¼Œå¦‚<code>Promise</code></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> $p1 <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'&lt;p&gt;ä¸€æ®µæ–‡å­—&lt;/p&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> $p2 <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'&lt;p&gt;ä¸€æ®µæ–‡å­—&lt;/p&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> $p3 <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'&lt;p&gt;ä¸€æ®µæ–‡å­—&lt;/p&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#container'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>$p1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>$p2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>$p3<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å¾®ä»»åŠ¡ï¼šDOMæ¸²æŸ“å‰è§¦å‘</span>
Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'length1'</span><span class="token punctuation">,</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#container'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">children</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Promise then'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// DOM æ¸²æŸ“äº†å—ï¼Ÿ</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token comment">// å®ä»»åŠ¡ï¼šDOMæ¸²æŸ“åè§¦å‘</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'length2'</span><span class="token punctuation">,</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#container'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">children</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'setTimeout'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// DOM æ¸²æŸ“äº†å—ï¼Ÿ</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="ä»-event-loopè§£é‡Š-ä¸ºä½•å¾®ä»»åŠ¡æ‰§è¡Œæ›´æ—©"><a href="#ä»-event-loopè§£é‡Š-ä¸ºä½•å¾®ä»»åŠ¡æ‰§è¡Œæ›´æ—©" class="header-anchor">#</a> ä» event loopè§£é‡Šï¼Œä¸ºä½•å¾®ä»»åŠ¡æ‰§è¡Œæ›´æ—©</h4> <ul><li>å¾®ä»»åŠ¡æ˜¯ES6è¯­æ³•è§„å®šçš„</li> <li>å®ä»»åŠ¡æ˜¯ç”±æµè§ˆå™¨è§„å®šçš„</li></ul> <p><img src="https://picmagic.oss-cn-beijing.aliyuncs.com/img/image-20220617194419109.png" alt="image-20220617194419109"></p> <h3 id="æè¿°-event-loop-æœºåˆ¶-å¯ç”»å›¾"><a href="#æè¿°-event-loop-æœºåˆ¶-å¯ç”»å›¾" class="header-anchor">#</a> æè¿° event loop æœºåˆ¶ ï¼ˆå¯ç”»å›¾ï¼‰</h3> <ul><li>å›é¡¾ event loop çš„è¿‡ç¨‹</li> <li>å’Œ DOM æ¸²æŸ“çš„å…³ç³»</li> <li>å¾®ä»»åŠ¡å’Œå®ä»»åŠ¡event loop è¿‡ç¨‹ä¸­çš„ä¸åŒå¤„ç†</li></ul> <h3 id="åœºæ™¯é¢˜-async-await-è¯­æ³•"><a href="#åœºæ™¯é¢˜-async-await-è¯­æ³•" class="header-anchor">#</a> åœºæ™¯é¢˜ - async/await è¯­æ³•</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Promise</span>
  <span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 100</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token number">100</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'c'</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// start</span>
<span class="token comment">// a 100</span>
<span class="token comment">// b 200</span>
</code></pre></div><h3 id="åœºæ™¯é¢˜-promiseå’Œsettimeoutçš„é¡ºåº"><a href="#åœºæ™¯é¢˜-promiseå’Œsettimeoutçš„é¡ºåº" class="header-anchor">#</a> åœºæ™¯é¢˜ - Promiseå’ŒsetTimeoutçš„é¡ºåº</h3> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 100 400 300 200</span>
</code></pre></div><h3 id="åœºæ™¯é¢˜-å¤–åŠ -async-awaitçš„é¡ºåºé—®é¢˜"><a href="#åœºæ™¯é¢˜-å¤–åŠ -async-awaitçš„é¡ºåºé—®é¢˜" class="header-anchor">#</a> åœºæ™¯é¢˜ - å¤–åŠ  async/awaitçš„é¡ºåºé—®é¢˜</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setTimeout'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// åˆå§‹åŒ– promiseæ—¶ï¼Œä¼ å…¥çš„å‡½æ•°ä¼šç«‹åˆ»è¢«æ‰§è¡Œ</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// åŒæ­¥ä»£ç æ‰§è¡Œå®Œæ¯•ï¼ˆevent loop - call stack è¢«æ¸…ç©ºï¼‰</span>
<span class="token comment">/**
 * script start
async1 start
async2
promise1
script end
async1 end
promise2
setTimeout
 */</span>
</code></pre></div></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/handbook/baseLayout.html" class="prev">
            ğŸŒ´å‰ç«¯åŸºç¡€-layout
          </a></span> <span class="next"><a href="/handbook/javascriptWeb.html">
            ğŸŒµå‰ç«¯åŸºç¡€-javascript-web
          </a></span></p></div> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-cb1513f6><li class="level-2" data-v-cb1513f6><a href="/handbook/baseJavascript.html#å˜é‡ç±»å‹ä¸è®¡ç®—" class="sidebar-link reco-side-å˜é‡ç±»å‹ä¸è®¡ç®—" data-v-cb1513f6>å˜é‡ç±»å‹ä¸è®¡ç®—</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#ç±»å‹è½¬æ¢" class="sidebar-link reco-side-ç±»å‹è½¬æ¢" data-v-cb1513f6>ç±»å‹è½¬æ¢</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#typeofèƒ½åˆ¤æ–­å“ªäº›ç±»å‹" class="sidebar-link reco-side-typeofèƒ½åˆ¤æ–­å“ªäº›ç±»å‹" data-v-cb1513f6>typeofèƒ½åˆ¤æ–­å“ªäº›ç±»å‹ï¼Ÿ</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#ä½•æ—¶ä½¿ç”¨-ä½•æ—¶ä½¿ç”¨" class="sidebar-link reco-side-ä½•æ—¶ä½¿ç”¨-ä½•æ—¶ä½¿ç”¨" data-v-cb1513f6>ä½•æ—¶ä½¿ç”¨===ï¼Œä½•æ—¶ä½¿ç”¨==</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹çš„åŒºåˆ«" class="sidebar-link reco-side-å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹çš„åŒºåˆ«" data-v-cb1513f6>å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹çš„åŒºåˆ«</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#æ‰‹å†™æ·±æ‹·è´" class="sidebar-link reco-side-æ‰‹å†™æ·±æ‹·è´" data-v-cb1513f6>æ‰‹å†™æ·±æ‹·è´</a></li><li class="level-2" data-v-cb1513f6><a href="/handbook/baseJavascript.html#åŸå‹å’ŒåŸå‹é“¾" class="sidebar-link reco-side-åŸå‹å’ŒåŸå‹é“¾" data-v-cb1513f6>åŸå‹å’ŒåŸå‹é“¾</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#classå’Œç»§æ‰¿" class="sidebar-link reco-side-classå’Œç»§æ‰¿" data-v-cb1513f6>classå’Œç»§æ‰¿</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#ç±»å‹åˆ¤æ–­instanceof" class="sidebar-link reco-side-ç±»å‹åˆ¤æ–­instanceof" data-v-cb1513f6>ç±»å‹åˆ¤æ–­instanceof</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#åŸå‹å’ŒåŸå‹é“¾-2" class="sidebar-link reco-side-åŸå‹å’ŒåŸå‹é“¾-2" data-v-cb1513f6>åŸå‹å’ŒåŸå‹é“¾</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#å¦‚ä½•å‡†ç¡®åˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯ä¸æ˜¯æ•°ç»„" class="sidebar-link reco-side-å¦‚ä½•å‡†ç¡®åˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯ä¸æ˜¯æ•°ç»„" data-v-cb1513f6>å¦‚ä½•å‡†ç¡®åˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯ä¸æ˜¯æ•°ç»„ï¼Ÿ</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#æ‰‹å†™ä¸€ä¸ªç®€æ˜“çš„jquery-è€ƒè™‘æ’ä»¶å’Œæ‰©å±•æ€§" class="sidebar-link reco-side-æ‰‹å†™ä¸€ä¸ªç®€æ˜“çš„jquery-è€ƒè™‘æ’ä»¶å’Œæ‰©å±•æ€§" data-v-cb1513f6>æ‰‹å†™ä¸€ä¸ªç®€æ˜“çš„jQueryï¼Œè€ƒè™‘æ’ä»¶å’Œæ‰©å±•æ€§</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#classçš„åŸå‹æœ¬è´¨-æ€ä¹ˆç†è§£" class="sidebar-link reco-side-classçš„åŸå‹æœ¬è´¨-æ€ä¹ˆç†è§£" data-v-cb1513f6>classçš„åŸå‹æœ¬è´¨ï¼Œæ€ä¹ˆç†è§£ï¼Ÿ</a></li><li class="level-2" data-v-cb1513f6><a href="/handbook/baseJavascript.html#ä½œç”¨åŸŸä¸é—­åŒ…" class="sidebar-link reco-side-ä½œç”¨åŸŸä¸é—­åŒ…" data-v-cb1513f6>ä½œç”¨åŸŸä¸é—­åŒ…</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#ä½œç”¨åŸŸå’Œè‡ªç”±å˜é‡" class="sidebar-link reco-side-ä½œç”¨åŸŸå’Œè‡ªç”±å˜é‡" data-v-cb1513f6>ä½œç”¨åŸŸå’Œè‡ªç”±å˜é‡</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#é—­åŒ…" class="sidebar-link reco-side-é—­åŒ…" data-v-cb1513f6>é—­åŒ…</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#this" class="sidebar-link reco-side-this" data-v-cb1513f6>this</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#thisçš„ä¸åŒåº”ç”¨åœºæ™¯-å¦‚ä½•å–å€¼" class="sidebar-link reco-side-thisçš„ä¸åŒåº”ç”¨åœºæ™¯-å¦‚ä½•å–å€¼" data-v-cb1513f6>thisçš„ä¸åŒåº”ç”¨åœºæ™¯ï¼Œå¦‚ä½•å–å€¼?</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#æ‰‹å†™bindå‡½æ•°" class="sidebar-link reco-side-æ‰‹å†™bindå‡½æ•°" data-v-cb1513f6>æ‰‹å†™bindå‡½æ•°</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#å®é™…å¼€å‘ä¸­é—­åŒ…çš„åº”ç”¨åœºæ™¯-ä¸¾ä¾‹è¯´æ˜" class="sidebar-link reco-side-å®é™…å¼€å‘ä¸­é—­åŒ…çš„åº”ç”¨åœºæ™¯-ä¸¾ä¾‹è¯´æ˜" data-v-cb1513f6>å®é™…å¼€å‘ä¸­é—­åŒ…çš„åº”ç”¨åœºæ™¯ï¼Œä¸¾ä¾‹è¯´æ˜</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#åˆ›å»º10ä¸ª-a-ç‚¹å‡»å¼¹å‡ºåºå·" class="sidebar-link reco-side-åˆ›å»º10ä¸ª-a-ç‚¹å‡»å¼¹å‡ºåºå·" data-v-cb1513f6>åˆ›å»º10ä¸ª&lt;a&gt;,ç‚¹å‡»å¼¹å‡ºåºå·</a></li><li class="level-2" data-v-cb1513f6><a href="/handbook/baseJavascript.html#å¼‚æ­¥" class="sidebar-link reco-side-å¼‚æ­¥" data-v-cb1513f6>å¼‚æ­¥</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#å•çº¿ç¨‹å’Œå¼‚æ­¥" class="sidebar-link reco-side-å•çº¿ç¨‹å’Œå¼‚æ­¥" data-v-cb1513f6>å•çº¿ç¨‹å’Œå¼‚æ­¥</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#åº”ç”¨åœºæ™¯" class="sidebar-link reco-side-åº”ç”¨åœºæ™¯" data-v-cb1513f6>åº”ç”¨åœºæ™¯</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#callback-hell-å’Œ-promise" class="sidebar-link reco-side-callback-hell-å’Œ-promise" data-v-cb1513f6>callback hell å’Œ Promise</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ" class="sidebar-link reco-side-åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ" data-v-cb1513f6>åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ?</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#æ‰‹å†™ç”¨promiseåŠ è½½ä¸€å¼ å›¾ç‰‡" class="sidebar-link reco-side-æ‰‹å†™ç”¨promiseåŠ è½½ä¸€å¼ å›¾ç‰‡" data-v-cb1513f6>æ‰‹å†™ç”¨PromiseåŠ è½½ä¸€å¼ å›¾ç‰‡</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#å‰ç«¯ä½¿ç”¨å¼‚æ­¥çš„åœºæ™¯æœ‰å“ªäº›" class="sidebar-link reco-side-å‰ç«¯ä½¿ç”¨å¼‚æ­¥çš„åœºæ™¯æœ‰å“ªäº›" data-v-cb1513f6>å‰ç«¯ä½¿ç”¨å¼‚æ­¥çš„åœºæ™¯æœ‰å“ªäº›?</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#ä»£ç é¢˜" class="sidebar-link reco-side-ä»£ç é¢˜" data-v-cb1513f6>ä»£ç é¢˜</a></li><li class="level-2" data-v-cb1513f6><a href="/handbook/baseJavascript.html#å¼‚æ­¥è¿›é˜¶" class="sidebar-link reco-side-å¼‚æ­¥è¿›é˜¶" data-v-cb1513f6>å¼‚æ­¥è¿›é˜¶</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#event-loop-äº‹ä»¶å¾ªç¯-äº‹ä»¶è½®è¯¢" class="sidebar-link reco-side-event-loop-äº‹ä»¶å¾ªç¯-äº‹ä»¶è½®è¯¢" data-v-cb1513f6>event loop(äº‹ä»¶å¾ªç¯/äº‹ä»¶è½®è¯¢)</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#promise-2" class="sidebar-link reco-side-promise-2" data-v-cb1513f6>Promise</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#async-await" class="sidebar-link reco-side-async-await" data-v-cb1513f6>async/await</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#å®ä»»åŠ¡macrotaskå’Œå¾®ä»»åŠ¡microtask" class="sidebar-link reco-side-å®ä»»åŠ¡macrotaskå’Œå¾®ä»»åŠ¡microtask" data-v-cb1513f6>å®ä»»åŠ¡macroTaskå’Œå¾®ä»»åŠ¡microTask</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#æè¿°-event-loop-æœºåˆ¶-å¯ç”»å›¾" class="sidebar-link reco-side-æè¿°-event-loop-æœºåˆ¶-å¯ç”»å›¾" data-v-cb1513f6>æè¿° event loop æœºåˆ¶ ï¼ˆå¯ç”»å›¾ï¼‰</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#åœºæ™¯é¢˜-async-await-è¯­æ³•" class="sidebar-link reco-side-åœºæ™¯é¢˜-async-await-è¯­æ³•" data-v-cb1513f6>åœºæ™¯é¢˜ - async/await è¯­æ³•</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#åœºæ™¯é¢˜-promiseå’Œsettimeoutçš„é¡ºåº" class="sidebar-link reco-side-åœºæ™¯é¢˜-promiseå’Œsettimeoutçš„é¡ºåº" data-v-cb1513f6>åœºæ™¯é¢˜ - Promiseå’ŒsetTimeoutçš„é¡ºåº</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/baseJavascript.html#åœºæ™¯é¢˜-å¤–åŠ -async-awaitçš„é¡ºåºé—®é¢˜" class="sidebar-link reco-side-åœºæ™¯é¢˜-å¤–åŠ -async-awaitçš„é¡ºåºé—®é¢˜" data-v-cb1513f6>åœºæ™¯é¢˜ - å¤–åŠ  async/awaitçš„é¡ºåºé—®é¢˜</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.ec3c4e52.js" defer></script><script src="/assets/js/3.a4c2a10e.js" defer></script><script src="/assets/js/1.f00e5e10.js" defer></script><script src="/assets/js/24.f5876fa3.js" defer></script>
  </body>
</html>
